<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>VIAN Academy - Giỏ hàng &amp; Thanh toán</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#2b8cee",
            "background-light": "#f6f7f8",
            "background-dark": "#101922",
            "brand-red": "#D84A49",
            "brand-blue": "#1C3F97",
          },
          fontFamily: {
            "display": ["Lexend", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.25rem",
            "lg": "0.5rem",
            "xl": "0.75rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>
<style>
    .material-symbols-outlined {
      font-variation-settings:
        'FILL' 0,
        'wght' 400,
        'GRAD' 0,
        'opsz' 24
    }
  </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-[#0d141b] dark:text-slate-200">
<div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
<div class="layout-container flex h-full grow flex-col">
<header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-slate-200 dark:border-slate-800 px-4 md:px-10 py-3 bg-white dark:bg-background-dark/80 backdrop-blur-sm sticky top-0 z-20">
<div class="flex items-center gap-4 text-[#0d141b] dark:text-slate-50">
<div class="size-6 text-brand-blue">
<svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<path d="M42.4379 44C42.4379 44 36.0744 33.9038 41.1692 24C46.8624 12.9336 42.2078 4 42.2078 4L7.01134 4C7.01134 4 11.6577 12.932 5.96912 23.9969C0.876273 33.9029 7.27094 44 7.27094 44L42.4379 44Z" fill="currentColor"></path>
</svg>
</div>
<h2 class="text-[#0d141b] dark:text-slate-50 text-lg font-bold leading-tight tracking-[-0.015em]">VIAN Academy</h2>
</div>
<div class="hidden md:flex flex-1 justify-center gap-8">
<div class="flex items-center gap-9">
<a class="text-[#0d141b] dark:text-slate-300 text-sm font-medium leading-normal hover:text-brand-blue dark:hover:text-brand-blue" href="#">Khóa học</a>
<a class="text-[#0d141b] dark:text-slate-300 text-sm font-medium leading-normal hover:text-brand-blue dark:hover:text-brand-blue" href="#">Lớp học của tôi</a>
<a class="text-[#0d141b] dark:text-slate-300 text-sm font-medium leading-normal hover:text-brand-blue dark:hover:text-brand-blue" href="#">Cộng đồng</a>
</div>
</div>
<div class="flex items-center gap-2">
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 w-10 bg-slate-100 dark:bg-slate-800 text-[#0d141b] dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700">
<span class="material-symbols-outlined text-xl">shopping_cart</span>
</button>
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 w-10 bg-slate-100 dark:bg-slate-800 text-[#0d141b] dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700">
<span class="material-symbols-outlined text-xl">notifications</span>
</button>
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="User avatar image" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuD7vdtRHk_KZjB-YTbXjgIku7kIwnSQIacApO9Nh9AZcZqm3nX-rX-wfhOZbFJjVZOk3DK6lDtVYw-Pn19Y0QapI2MPhSpoidSrGNsN47FwKZVWDViScw9Pgl0iaDD1mpsb9SZTmsFWfbB9oiFZ3_WdLjqf81UjCPbk69ULOO_N0YtxoMLwHBZrK28JLMU8Xsl-IhCGng6IMYloyR-mYFeEBsrFXl0F7NukX1dyMhYBYeKvMz7PggYmZ-vRwoChH-qcQfU8Z6B5wU8");'></div>
</div>
</header>
<main class="px-4 sm:px-6 lg:px-8 py-8 md:py-12">
<div class="layout-content-container flex flex-col max-w-6xl mx-auto flex-1 gap-8">
<div class="flex flex-col gap-6" id="cart-section">
<div class="flex flex-wrap gap-2 text-sm md:text-base">
<a class="text-slate-500 dark:text-slate-400 font-medium leading-normal hover:text-brand-blue" href="#">Trang chủ</a>
<span class="text-slate-500 dark:text-slate-400 font-medium leading-normal">/</span>
<span class="text-[#0d141b] dark:text-white font-bold leading-normal">Giỏ hàng</span>
</div>
<div class="flex flex-wrap justify-between items-baseline gap-3">
<h1 class="text-brand-blue dark:text-white text-3xl md:text-4xl font-black leading-tight tracking-tighter uppercase">Giỏ hàng của bạn</h1>
</div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
<div class="lg:col-span-2 flex flex-col gap-4 bg-white dark:bg-background-dark/80 p-4 sm:p-6 rounded-none border border-slate-200 dark:border-slate-800 shadow-md">
<div id="cartItemsContainer" class="flex flex-col divide-y divide-slate-200 dark:divide-slate-800"></div>
<div id="cartEmptyState" class="hidden flex flex-col items-center justify-center gap-3 py-10 text-center">
<span class="material-symbols-outlined text-5xl text-brand-blue">shopping_bag</span>
<p class="text-lg font-bold text-brand-blue dark:text-slate-200">Giỏ hàng của bạn đang trống</p>
<p class="text-sm text-slate-500 dark:text-slate-400 max-w-md">Khám phá danh mục khóa học để thêm những khóa học yêu thích vào giỏ và tiếp tục hành trình học tập.</p>
<a href="../trang_danh_mục_khóa_học/index.html" class="mt-2 px-5 py-2 rounded-full bg-brand-blue text-white text-sm font-bold hover:bg-brand-blue/90 transition-colors">Khám phá khóa học</a>
</div>
</div>
<div class="lg:col-span-1 bg-white dark:bg-background-dark/80 p-6 rounded-none border border-slate-200 dark:border-slate-800 shadow-md flex flex-col gap-4">
<h3 class="text-xl font-black uppercase text-brand-blue dark:text-white">Tóm tắt đơn hàng</h3>
<div class="flex justify-between text-slate-600 dark:text-slate-300 text-base font-bold">
<span>Tạm tính</span>
<span id="summarySubtotal">$0.00</span>
</div>
<div class="flex justify-between text-slate-600 dark:text-slate-300 text-base font-bold">
<span>Giảm giá</span>
<span id="summaryDiscount">-$0.00</span>
</div>
<div class="border-t-2 border-dashed border-slate-300 dark:border-slate-700 my-2"></div>
<div class="bg-brand-blue text-white p-4 flex justify-between items-center font-black text-xl">
<span>TỔNG CỘNG</span>
<span id="summaryTotal">$0.00</span>
</div>
<div class="flex flex-col gap-2">
<div class="flex gap-2">
<input id="couponInput" class="w-full rounded-none border-2 border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 focus:ring-brand-blue focus:border-brand-blue text-sm font-bold placeholder:font-bold" placeholder="MÃ GIẢM GIÁ" type="text"/>
<button id="applyCouponBtn" class="flex-shrink-0 px-4 py-2 rounded-none bg-slate-200 dark:bg-slate-700 text-[#0d141b] dark:text-white text-sm font-black hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors">ÁP DỤNG</button>
</div>
<p id="couponStatus" class="text-xs font-semibold text-brand-blue dark:text-slate-300 hidden"></p>
</div>
<button id="proceedToCheckoutBtn" class="w-full mt-2 flex items-center justify-center gap-2 rounded-none bg-brand-red h-12 px-6 text-white text-base font-black leading-normal tracking-wide shadow-md hover:bg-brand-red/90 focus:outline-none focus:ring-2 focus:ring-brand-red focus:ring-offset-2 dark:focus:ring-offset-background-dark uppercase">
<span>Thanh toán</span>
<span class="material-symbols-outlined">arrow_forward</span>
</button>
</div>
</div>
</div>
<div class="my-8 border-t border-dashed border-slate-300 dark:border-slate-700"></div>
<div class="flex flex-col gap-6" id="checkout-section">
<div class="flex flex-wrap gap-2 text-sm md:text-base">
<a class="text-slate-500 dark:text-slate-400 font-medium leading-normal hover:text-brand-blue" href="#">Trang chủ</a>
<span class="text-slate-500 dark:text-slate-400 font-medium leading-normal">/</span>
<a class="text-slate-500 dark:text-slate-400 font-medium leading-normal hover:text-brand-blue" href="#">Giỏ hàng</a>
<span class="text-slate-500 dark:text-slate-400 font-medium leading-normal">/</span>
<span class="text-[#0d141b] dark:text-white font-bold leading-normal">Thanh toán</span>
</div>
<div class="flex flex-wrap justify-between items-baseline gap-3">
<h1 class="text-brand-blue dark:text-white text-3xl md:text-4xl font-black leading-tight tracking-tighter uppercase">Thanh toán</h1>
</div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
<div class="lg:col-span-2 flex flex-col gap-8">
<div class="bg-white dark:bg-background-dark/80 p-6 rounded-none border border-slate-200 dark:border-slate-800 shadow-md flex flex-col gap-4">
<h3 class="text-xl font-black uppercase text-brand-blue dark:text-white">Chi tiết thanh toán</h3>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1" for="fullName">Họ và tên</label>
<input class="w-full rounded-none border-2 border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-brand-blue focus:border-brand-blue text-sm" id="fullName" placeholder="John Doe" type="text"/>
</div>
<div>
<label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1" for="email">Địa chỉ Email</label>
<input class="w-full rounded-none border-2 border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-brand-blue focus:border-brand-blue text-sm" id="email" placeholder="you@example.com" type="email"/>
</div>
</div>
<div>
<label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1" for="address">Địa chỉ (Tùy chọn)</label>
<input class="w-full rounded-none border-2 border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-brand-blue focus:border-brand-blue text-sm" id="address" placeholder="123 Learning Lane" type="text"/>
</div>
</div>
<div class="bg-white dark:bg-background-dark/80 p-6 rounded-none border border-slate-200 dark:border-slate-800 shadow-md flex flex-col gap-4">
<h3 class="text-xl font-black uppercase text-brand-blue dark:text-white">Phương thức thanh toán</h3>
<div class="space-y-4">
<div class="border-2 border-slate-300 dark:border-slate-700 rounded-none p-4 has-[:checked]:border-brand-red has-[:checked]:ring-2 has-[:checked]:ring-brand-red/50 bg-white dark:bg-slate-800">
<label class="flex items-center gap-4 cursor-pointer">
<input checked="" class="h-5 w-5 text-brand-red focus:ring-brand-red border-slate-400" name="paymentMethod" type="radio" value="card"/>
<span class="font-bold text-base">Thẻ Tín dụng/Ghi nợ</span>
</label>
<div class="mt-4 pl-9 space-y-4">
<input class="w-full rounded-none border-2 border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-brand-blue focus:border-brand-blue text-sm" placeholder="Số thẻ" type="text"/>
<div class="grid grid-cols-2 gap-4">
<input class="rounded-none border-2 border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-brand-blue focus:border-brand-blue text-sm" placeholder="MM / YY" type="text"/>
<input class="rounded-none border-2 border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-brand-blue focus:border-brand-blue text-sm" placeholder="CVC" type="text"/>
</div>
</div>
</div>
<div class="border-2 border-slate-300 dark:border-slate-700 rounded-none p-4 has-[:checked]:border-brand-red has-[:checked]:ring-2 has-[:checked]:ring-brand-red/50 bg-white dark:bg-slate-800">
<label class="flex items-center gap-4 cursor-pointer">
<input class="h-5 w-5 text-brand-red focus:ring-brand-red border-slate-400" name="paymentMethod" type="radio" value="ewallet"/>
<span class="font-bold text-base">Ví điện tử (Momo, ZaloPay)</span>
</label>
</div>
<div class="border-2 border-slate-300 dark:border-slate-700 rounded-none p-4 has-[:checked]:border-brand-red has-[:checked]:ring-2 has-[:checked]:ring-brand-red/50 bg-white dark:bg-slate-800">
<label class="flex items-center gap-4 cursor-pointer">
<input class="h-5 w-5 text-brand-red focus:ring-brand-red border-slate-400" name="paymentMethod" type="radio" value="bank"/>
<span class="font-bold text-base">Chuyển khoản ngân hàng</span>
</label>
</div>
</div>
</div>
</div>
<div class="lg:col-span-1 lg:sticky top-24">
<div class="bg-white dark:bg-background-dark/80 p-6 rounded-none border border-slate-200 dark:border-slate-800 shadow-md flex flex-col gap-4">
<h3 class="text-xl font-black uppercase text-brand-blue dark:text-white">Tóm tắt đơn hàng</h3>
<div id="checkoutItemsContainer" class="space-y-3"></div>
<div class="border-t-2 border-dashed border-slate-300 dark:border-slate-700 my-2"></div>
<div class="flex justify-between text-slate-600 dark:text-slate-300 text-base font-bold">
<span>Tạm tính</span>
<span id="checkoutSubtotal">$0.00</span>
</div>
<div class="bg-brand-blue text-white p-4 -mx-6 flex justify-between items-center font-black text-xl">
<span>TỔNG CỘNG</span>
<span id="checkoutTotal">$0.00</span>
</div>
<div class="flex items-start gap-3 mt-4">
<input class="h-4 w-4 rounded-sm border-slate-400 text-brand-red focus:ring-brand-red mt-0.5" id="terms" type="checkbox"/>
<label class="text-sm text-slate-600 dark:text-slate-400" for="terms">
                      Tôi đồng ý với <a class="font-bold text-brand-blue hover:underline" href="#">Điều khoản Dịch vụ</a> và <a class="font-bold text-brand-blue hover:underline" href="#">Chính sách Bảo mật</a>.
                    </label>
</div>
<button id="placeOrderBtn" class="w-full mt-2 flex items-center justify-center gap-2 rounded-none bg-brand-red h-12 px-6 text-white text-base font-black leading-normal tracking-wide shadow-md hover:bg-brand-red/90 focus:outline-none focus:ring-2 focus:ring-brand-red focus:ring-offset-2 dark:focus:ring-offset-background-dark disabled:bg-slate-300 dark:disabled:bg-slate-700 disabled:cursor-not-allowed uppercase" disabled>
<span class="material-symbols-outlined">lock</span>
<span>Đặt hàng</span>
</button>
<div class="flex items-center justify-center gap-2 text-xs text-slate-500 dark:text-slate-400 mt-2">
<span class="material-symbols-outlined text-base">verified_user</span>
<span>Thanh toán an toàn SSL</span>
</div>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
</div>
<script>
class ShoppingCart {
  constructor() {
    this.storageKey = 'cart';
    this.couponStorageKey = 'cartCoupon';
    this.coupons = {
      'SAVE10': { discount: 0.10, type: 'percentage', label: 'Giảm 10%' },
      'SAVE50': { discount: 50, type: 'fixed', label: 'Giảm $50' },
      'SUMMER20': { discount: 0.20, type: 'percentage', label: 'Giảm 20%' }
    };

    this.cart = this.loadCart();
    this.appliedCoupon = this.loadCoupon();

    this.cacheDom();
    this.bindEvents();
    this.render();
    this.updateTotals();
  }

  cacheDom() {
    this.cartItemsContainer = document.getElementById('cartItemsContainer');
    this.checkoutItemsContainer = document.getElementById('checkoutItemsContainer');
    this.cartEmptyState = document.getElementById('cartEmptyState');

    this.subtotalEl = document.getElementById('summarySubtotal');
    this.discountEl = document.getElementById('summaryDiscount');
    this.totalEl = document.getElementById('summaryTotal');
    this.checkoutSubtotalEl = document.getElementById('checkoutSubtotal');
    this.checkoutTotalEl = document.getElementById('checkoutTotal');

    this.couponInput = document.getElementById('couponInput');
    this.couponBtn = document.getElementById('applyCouponBtn');
    this.couponStatus = document.getElementById('couponStatus');

    this.proceedToCheckoutBtn = document.getElementById('proceedToCheckoutBtn');
    this.placeOrderBtn = document.getElementById('placeOrderBtn');
    this.termsCheckbox = document.getElementById('terms');

    this.fullNameInput = document.getElementById('fullName');
    this.emailInput = document.getElementById('email');
  }

  bindEvents() {
    this.cartItemsContainer.addEventListener('click', (event) => {
      const button = event.target.closest('button[data-action="remove-item"]');
      if (button) {
        const courseId = Number(button.dataset.id);
        this.removeItem(courseId);
      }
    });

    this.proceedToCheckoutBtn.addEventListener('click', () => this.scrollToCheckout());

    this.couponBtn.addEventListener('click', () => {
      const code = this.couponInput.value.trim();
      if (!code) {
        this.showCouponStatus('Vui lòng nhập mã giảm giá.', 'warning');
        return;
      }
      this.applyCoupon(code);
    });

    this.termsCheckbox.addEventListener('change', (event) => {
      this.placeOrderBtn.disabled = !event.target.checked || !this.cart.length;
    });

    this.placeOrderBtn.addEventListener('click', () => this.processOrder());

    document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
      radio.addEventListener('change', (event) => this.handlePaymentChange(event));
    });
  }

  loadCart() {
    try {
      const raw = localStorage.getItem(this.storageKey);
      if (raw) {
        const cart = JSON.parse(raw);
        if (Array.isArray(cart)) {
          return cart;
        }
      }
    } catch (error) {
      console.error('Không thể đọc giỏ hàng:', error);
    }
    return [];
  }

  saveCart() {
    localStorage.setItem(this.storageKey, JSON.stringify(this.cart));
  }

  loadCoupon() {
    try {
      const raw = localStorage.getItem(this.couponStorageKey);
      if (!raw) return null;

      const coupon = JSON.parse(raw);
      if (coupon && this.coupons[coupon.code]) {
        return coupon;
      }
    } catch (error) {
      console.error('Không thể đọc coupon:', error);
    }
    return null;
  }

  saveCoupon() {
    if (this.appliedCoupon) {
      localStorage.setItem(this.couponStorageKey, JSON.stringify(this.appliedCoupon));
    } else {
      localStorage.removeItem(this.couponStorageKey);
    }
  }

  formatCurrency(amount) {
    return '$' + amount.toFixed(2);
  }

  render() {
    if (!this.cart.length) {
      this.cartItemsContainer.innerHTML = '';
      this.checkoutItemsContainer.innerHTML = '';
      this.cartEmptyState.classList.remove('hidden');
      this.placeOrderBtn.disabled = true;
      return;
    }

    this.cartEmptyState.classList.add('hidden');

    this.cartItemsContainer.innerHTML = this.cart.map(item => `
      <div class="flex flex-wrap gap-4 p-4 items-center justify-between">
        <div class="flex items-center gap-4 flex-1 min-w-[240px]">
          <div class="bg-center bg-no-repeat bg-cover rounded-md h-[70px] w-32 flex-shrink-0" style="background-image: url('${item.image}')"></div>
          <div class="flex flex-col">
            <p class="text-[#0d141b] dark:text-white text-base font-bold leading-tight">${item.name}</p>
            <p class="text-slate-500 dark:text-slate-400 text-sm font-normal leading-normal">${item.instructor || ''}</p>
          </div>
        </div>
        <div class="shrink-0 flex items-center gap-4">
          <p class="text-[#0d141b] dark:text-white text-lg font-extrabold leading-normal">${this.formatCurrency(item.price)}</p>
          <button data-action="remove-item" data-id="${item.id}" class="text-slate-500 dark:text-slate-400 hover:text-red-600 dark:hover:text-red-500 flex size-9 items-center justify-center rounded-full hover:bg-red-500/10 transition-colors" aria-label="Xóa khóa học">
            <span class="material-symbols-outlined text-xl">delete</span>
          </button>
        </div>
      </div>
    `).join('');

    this.checkoutItemsContainer.innerHTML = this.cart.map(item => `
      <div class="flex items-center gap-3">
        <div class="bg-center bg-no-repeat bg-cover rounded-md h-12 w-20 flex-shrink-0" style="background-image: url('${item.image}')"></div>
        <div class="text-sm flex-1">
          <p class="font-bold line-clamp-1" title="${item.name}">${item.name}</p>
          <p class="text-slate-500 dark:text-slate-400 font-extrabold">${this.formatCurrency(item.price)}</p>
        </div>
      </div>
    `).join('');

    this.placeOrderBtn.disabled = !this.termsCheckbox.checked;
  }

  updateTotals() {
    const subtotal = this.cart.reduce((sum, item) => sum + Number(item.price || 0), 0);
    const discount = this.calculateDiscount(subtotal);
    const total = Math.max(subtotal - discount, 0);

    this.subtotalEl.textContent = this.formatCurrency(subtotal);
    this.discountEl.textContent = `-${this.formatCurrency(discount)}`;
    this.totalEl.textContent = this.formatCurrency(total);

    this.checkoutSubtotalEl.textContent = this.formatCurrency(subtotal);
    this.checkoutTotalEl.textContent = this.formatCurrency(total);

    if (this.appliedCoupon) {
      this.showCouponStatus(`Đã áp dụng mã ${this.appliedCoupon.code} (${this.coupons[this.appliedCoupon.code].label}).`, 'success');
      this.couponInput.value = this.appliedCoupon.code;
    } else {
      this.showCouponStatus('', 'hidden');
    }
  }

  calculateDiscount(subtotal) {
    if (!this.appliedCoupon || !this.coupons[this.appliedCoupon.code]) {
      return 0;
    }

    const { type, discount } = this.coupons[this.appliedCoupon.code];
    if (type === 'percentage') {
      return subtotal * discount;
    }
    return Math.min(discount, subtotal);
  }

  applyCoupon(code) {
    const normalized = code.toUpperCase();
    const coupon = this.coupons[normalized];

    if (!coupon) {
      this.appliedCoupon = null;
      this.saveCoupon();
      this.updateTotals();
      this.showCouponStatus('Mã giảm giá không hợp lệ.', 'error');
      return;
    }

    this.appliedCoupon = { code: normalized };
    this.saveCoupon();
    this.updateTotals();
    this.showCouponStatus(`✓ Mã ${normalized} đã được áp dụng.`, 'success');
  }

  showCouponStatus(message, type) {
    if (!this.couponStatus) return;

    if (!message) {
      this.couponStatus.classList.add('hidden');
      return;
    }

    const colors = {
      success: 'text-emerald-600 dark:text-emerald-400',
      error: 'text-red-500 dark:text-red-400',
      warning: 'text-amber-500 dark:text-amber-400',
      hidden: ''
    };

    this.couponStatus.className = `text-xs font-semibold ${colors[type] || colors.success}`;
    this.couponStatus.textContent = message;
    this.couponStatus.classList.remove('hidden');
  }

  removeItem(courseId) {
    this.cart = this.cart.filter(item => item.id !== courseId);
    this.saveCart();
    this.render();
    this.updateTotals();
    this.notify('Khóa học đã được xóa khỏi giỏ hàng.', 'info');

    if (!this.cart.length) {
      this.appliedCoupon = null;
      this.saveCoupon();
    }
  }

  scrollToCheckout() {
    const checkoutSection = document.getElementById('checkout-section');
    if (checkoutSection) {
      checkoutSection.scrollIntoView({ behavior: 'smooth' });
    }
  }

  handlePaymentChange(event) {
    const cardDetails = document.querySelector('input[placeholder="Số thẻ"]')?.parentElement?.parentElement;
    if (!cardDetails) return;

    if (event.target.value === 'card') {
      cardDetails.style.display = 'block';
    } else {
      cardDetails.style.display = 'none';
    }
  }

  processOrder() {
    if (!this.cart.length) {
      this.notify('Giỏ hàng đang trống. Vui lòng thêm khóa học trước khi thanh toán.', 'warning');
      return;
    }

    const fullName = this.fullNameInput.value.trim();
    const email = this.emailInput.value.trim();
    const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked')?.value;

    if (!fullName || !email) {
      this.notify('Vui lòng điền đầy đủ họ tên và email.', 'error');
      return;
    }

    if (!paymentMethod) {
      this.notify('Vui lòng chọn phương thức thanh toán.', 'error');
      return;
    }

    const total = this.checkoutTotalEl.textContent;

    this.notify('✓ Đặt hàng thành công! Kiểm tra email để xem chi tiết.', 'success');

    setTimeout(() => {
      alert(`✓ Đặt hàng thành công!\n\nThông tin đơn hàng:\n- Tên: ${fullName}\n- Email: ${email}\n- Tổng cộng: ${total}\n- Phương thức: ${paymentMethod}\n\nChúc bạn học tập hiệu quả cùng VIAN Academy!`);
    }, 100);

    this.cart = [];
    this.appliedCoupon = null;
    this.saveCart();
    this.saveCoupon();
    this.render();
    this.updateTotals();

    setTimeout(() => {
      window.location.href = '../trang_danh_mục_khóa_học/index.html';
    }, 2000);
  }

  notify(message, type = 'info') {
    const colors = {
      success: 'bg-emerald-500',
      error: 'bg-red-500',
      warning: 'bg-amber-500',
      info: 'bg-brand-blue'
    };

    const toast = document.createElement('div');
    toast.textContent = message;
    toast.className = `${colors[type] || colors.info} text-white px-4 py-2 rounded-full shadow-lg fixed top-6 left-1/2 -translate-x-1/2 z-50 text-sm font-semibold animate-fade-in`;

    document.body.appendChild(toast);
    setTimeout(() => {
      toast.classList.add('animate-fade-out');
      toast.addEventListener('animationend', () => toast.remove());
    }, 2000);
  }
}

document.addEventListener('DOMContentLoaded', () => {
  const style = document.createElement('style');
  style.textContent = `
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeOut {
      from { opacity: 1; transform: translateY(0); }
      to { opacity: 0; transform: translateY(-10px); }
    }
    .animate-fade-in {
      animation: fadeIn 0.2s ease-out forwards;
    }
    .animate-fade-out {
      animation: fadeOut 0.15s ease-in forwards;
    }
  `;
  document.head.appendChild(style);

  new ShoppingCart();
});
</script>
</body></html>